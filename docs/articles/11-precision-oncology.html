<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis â€¢ meddecide</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meddecide</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.82</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-introduction.html">MedDecide 01: Introduction to Medical Decision Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/02-comprehensive-guide.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-advanced-features.html">Advanced Features in Interrater Agreement Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-analysis.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/03-roc-analysis.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/04-decision-tree-guide.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/05-decision-tree-analysis.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/06-decision-tree-vs-markov.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/06-jamovi-workflow-examples.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/07-bayesian-decision-curve-analysis.html">Bayesian Decision Curve Analysis - Advanced Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/07-decision-trees.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/07-kappasizeci-comprehensive.html">Sample Size Calculations for Interobserver Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/08-decision-panel-clinical.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/08-kappasizefixedn-comprehensive.html">Complete Guide to kappasizefixedn: Fixed Sample Size Kappa Power Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/09-decision-panel-advanced.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/09-kappasizepower-comprehensive.html">Complete Guide to kappasizepower: Power Analysis for Inter-rater Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/10-decision-panel-optimization.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/11-precision-oncology.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/12-nogoldstandard.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/13-diagnostic-tests.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/14-diagnostic-style-quick-guide.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/15-diagnostic-style-clustering.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/16-use-in-r.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/34-cotest-analysis.html">Co-Testing Analysis: Combining Diagnostic Tests for Better Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/35-screening-calculator-comprehensive.html">Screening Test Calculator: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/36-sequential-testing-comprehensive.html">Sequential Testing Analysis: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/38-modelbuilder-comprehensive.html">Clinical Prediction Model Builder</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</h1>
                        <h4 data-toc-skip class="author">ClinicoPath
Development Team</h4>
            
            <h4 data-toc-skip class="date">2025-07-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/11-precision-oncology.Rmd" class="external-link"><code>vignettes/11-precision-oncology.Rmd</code></a></small>
      <div class="d-none name"><code>11-precision-oncology.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Precision oncology represents the paradigm shift from
one-size-fits-all cancer treatment to personalized therapy based on
molecular characteristics of individual tumors. This vignette
demonstrates comprehensive biomarker analysis, treatment selection
algorithms, and outcome evaluation using ClinicoPath modules.</p>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Master precision oncology biomarker interpretation</li>
<li>Learn treatment selection algorithms based on molecular
profiles</li>
<li>Analyze biomarker-outcome relationships</li>
<li>Understand companion diagnostic requirements</li>
<li>Implement clinical decision support systems</li>
<li>Evaluate cost-effectiveness of precision medicine approaches</li>
</ul>
<div class="section level3">
<h3 id="clinical-context">Clinical Context<a class="anchor" aria-label="anchor" href="#clinical-context"></a>
</h3>
<p>Modern precision oncology requires integration of multiple biomarker
types:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Predictive Biomarkers</strong>: Guide treatment selection
(EGFR, HER2, PD-L1)</li>
<li>
<strong>Prognostic Biomarkers</strong>: Predict disease outcome
(Ki-67, p53)</li>
<li>
<strong>Pharmacogenomic Markers</strong>: Influence drug metabolism
(CYP2D6, TPMT)</li>
<li>
<strong>Resistance Markers</strong>: Predict treatment failure
(T790M, MET amplification)</li>
<li>
<strong>Immune Markers</strong>: Guide immunotherapy (MSI, TMB,
TILs)</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sbalci/ClinicoPathJamoviModule/" class="external-link">meddecide</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/" class="external-link">pROC</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="dataset-overview">Dataset Overview<a class="anchor" aria-label="anchor" href="#dataset-overview"></a>
</h2>
<div class="section level3">
<h3 id="precision-oncology-dataset">Precision Oncology Dataset<a class="anchor" aria-label="anchor" href="#precision-oncology-dataset"></a>
</h3>
<p>The <code>precision_oncology_data</code> dataset contains 116
patients with comprehensive molecular profiling and treatment outcomes,
representing real-world precision oncology scenarios.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the precision oncology dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dataset structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dataset dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">)</span>, <span class="st">"patients Ã—"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">)</span>, <span class="st">"variables\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patient demographics</span></span>
<span><span class="va">demographic_summary</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    median_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>,</span>
<span>    age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    female_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Gender</span> <span class="op">==</span> <span class="st">"Female"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    n_tumor_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Tumor_Type</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Patient Demographics:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">demographic_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tumor type distribution</span></span>
<span><span class="va">tumor_distribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Tumor_Type</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Tumor Type Distribution:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tumor_distribution</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="biomarker-landscape-analysis">Biomarker Landscape Analysis<a class="anchor" aria-label="anchor" href="#biomarker-landscape-analysis"></a>
</h2>
<div class="section level3">
<h3 id="actionable-biomarker-frequencies">Actionable Biomarker Frequencies<a class="anchor" aria-label="anchor" href="#actionable-biomarker-frequencies"></a>
</h3>
<p>Assess the prevalence of actionable molecular alterations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate biomarker frequencies</span></span>
<span><span class="va">biomarker_summary</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="co"># Targeted therapy biomarkers</span></span>
<span>    egfr_positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span>,</span>
<span>    her2_amplified <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">)</span>,</span>
<span>    braf_positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span>,</span>
<span>    alk_positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Immunotherapy biomarkers</span></span>
<span>    msi_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span>,</span>
<span>    pdl1_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>    pdl1_positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Any actionable alteration</span></span>
<span>    any_targeted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span> </span>
<span>                      <span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span> <span class="op">|</span></span>
<span>                      <span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span></span>
<span>                      <span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span>,</span>
<span>    </span>
<span>    any_immunotherapy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span> <span class="op">|</span> <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    total_patients <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to percentages and create summary table</span></span>
<span><span class="va">biomarker_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Biomarker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EGFR Mutation"</span>, <span class="st">"HER2 Amplification"</span>, <span class="st">"BRAF Mutation"</span>, </span>
<span>                <span class="st">"ALK Fusion"</span>, <span class="st">"MSI-High"</span>, <span class="st">"PD-L1 â‰¥50%"</span>, <span class="st">"PD-L1 â‰¥1%"</span>,</span>
<span>                <span class="st">"Any Targeted Therapy"</span>, <span class="st">"Any Immunotherapy"</span><span class="op">)</span>,</span>
<span>  Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">biomarker_summary</span><span class="op">$</span><span class="va">egfr_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">her2_amplified</span>,</span>
<span>            <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">braf_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">alk_positive</span>,</span>
<span>            <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">msi_high</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">pdl1_high</span>,</span>
<span>            <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">pdl1_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">any_targeted</span>,</span>
<span>            <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">any_immunotherapy</span><span class="op">)</span>,</span>
<span>  Percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">biomarker_summary</span><span class="op">$</span><span class="va">egfr_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">her2_amplified</span>,</span>
<span>                      <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">braf_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">alk_positive</span>,</span>
<span>                      <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">msi_high</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">pdl1_high</span>,</span>
<span>                      <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">pdl1_positive</span>, <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">any_targeted</span>,</span>
<span>                      <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">any_immunotherapy</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                     <span class="va">biomarker_summary</span><span class="op">$</span><span class="va">total_patients</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Actionable Biomarker Frequencies:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">biomarker_table</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tumor-specific-biomarker-patterns">Tumor-Specific Biomarker Patterns<a class="anchor" aria-label="anchor" href="#tumor-specific-biomarker-patterns"></a>
</h3>
<p>Analyze biomarker patterns by tumor type.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Biomarker frequencies by tumor type</span></span>
<span><span class="va">biomarker_by_tumor</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tumor_Type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    egfr_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    her2_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    braf_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    msi_high_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    pdl1_high_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Biomarker Frequencies by Tumor Type:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">biomarker_by_tumor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify tumor types with highest actionable biomarker rates</span></span>
<span><span class="va">high_actionable</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    actionable <span class="op">=</span> <span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span> </span>
<span>                <span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span> <span class="op">|</span></span>
<span>                <span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span></span>
<span>                <span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span></span>
<span>                <span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span> <span class="op">|</span></span>
<span>                <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tumor_Type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    actionable_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">actionable</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">actionable_rate</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Tumor Types with Highest Actionable Biomarker Rates:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">high_actionable</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="treatment-selection-algorithms">Treatment Selection Algorithms<a class="anchor" aria-label="anchor" href="#treatment-selection-algorithms"></a>
</h2>
<div class="section level3">
<h3 id="rule-based-treatment-assignment">Rule-Based Treatment Assignment<a class="anchor" aria-label="anchor" href="#rule-based-treatment-assignment"></a>
</h3>
<p>Implement clinical guideline-based treatment selection.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create treatment selection algorithm</span></span>
<span><span class="va">precision_oncology_data</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Primary treatment recommendation based on biomarkers</span></span>
<span>    primary_treatment <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">~</span> <span class="st">"EGFR TKI"</span>,</span>
<span>      <span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span> <span class="op">~</span> <span class="st">"HER2-Targeted Therapy"</span>,</span>
<span>      <span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">&amp;</span> <span class="va">Tumor_Type</span> <span class="op">==</span> <span class="st">"Melanoma"</span> <span class="op">~</span> <span class="st">"BRAF Inhibitor"</span>,</span>
<span>      <span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">~</span> <span class="st">"ALK Inhibitor"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Standard Chemotherapy"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Immunotherapy candidacy</span></span>
<span>    immunotherapy_candidate <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span> <span class="op">~</span> <span class="st">"First-line Immunotherapy"</span>,</span>
<span>      <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"First-line Anti-PD-1"</span>,</span>
<span>      <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Combination Therapy"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Chemotherapy First"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Treatment complexity score</span></span>
<span>    treatment_complexity <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">|</span> <span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span> <span class="op">~</span> <span class="st">"High"</span>,</span>
<span>      <span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span> <span class="op">|</span> <span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span> <span class="op">~</span> <span class="st">"High"</span>, </span>
<span>      <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>      <span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Standard"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Treatment recommendation summary</span></span>
<span><span class="va">treatment_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">primary_treatment</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Primary Treatment Recommendations:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">treatment_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="va">immunotherapy_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">immunotherapy_candidate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Immunotherapy Recommendations:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">immunotherapy_summary</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="biomarker-combination-analysis">Biomarker Combination Analysis<a class="anchor" aria-label="anchor" href="#biomarker-combination-analysis"></a>
</h3>
<p>Analyze patients with multiple actionable biomarkers.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify patients with multiple biomarkers</span></span>
<span><span class="va">precision_oncology_data</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    biomarker_count <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>    </span>
<span>    biomarker_category <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">biomarker_count</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"No Actionable Biomarkers"</span>,</span>
<span>      <span class="va">biomarker_count</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Single Biomarker"</span>,</span>
<span>      <span class="va">biomarker_count</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Multiple Biomarkers"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">biomarker_count_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">biomarker_category</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Biomarker Count Distribution:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">biomarker_count_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze combination patterns</span></span>
<span><span class="va">multiple_biomarker_cases</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">biomarker_count</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Patient_ID</span>, <span class="va">Tumor_Type</span>, <span class="va">EGFR_Mutation</span>, <span class="va">HER2_FISH_Status</span>, </span>
<span>         <span class="va">BRAF_Mutation</span>, <span class="va">ALK_Fusion</span>, <span class="va">MSI_Status</span>, <span class="va">PD_L1_TPS</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">multiple_biomarker_cases</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Patients with Multiple Actionable Biomarkers:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">multiple_biomarker_cases</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multiple_biomarker_cases</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="biomarker-outcome-relationships">Biomarker-Outcome Relationships<a class="anchor" aria-label="anchor" href="#biomarker-outcome-relationships"></a>
</h2>
<div class="section level3">
<h3 id="treatment-response-analysis">Treatment Response Analysis<a class="anchor" aria-label="anchor" href="#treatment-response-analysis"></a>
</h3>
<p>Assess biomarker predictive value for treatment response.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Response rates by biomarker status</span></span>
<span><span class="va">response_analysis</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    objective_response <span class="op">=</span> <span class="va">Treatment_Response</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="co"># Overall response rate</span></span>
<span>    overall_response_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Response by biomarker status</span></span>
<span>    egfr_positive_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    egfr_negative_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Negative"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    her2_amplified_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    her2_not_amplified_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">HER2_FISH_Status</span> <span class="op">!=</span> <span class="st">"Amplified"</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    msi_high_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    msi_low_mss_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">MSI_Status</span> <span class="op">!=</span> <span class="st">"MSI-High"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    </span>
<span>    pdl1_high_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    pdl1_low_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">objective_response</span><span class="op">[</span><span class="va">PD_L1_TPS</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Response Rates by Biomarker Status:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">response_analysis</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Statistical significance testing</span></span>
<span><span class="co"># EGFR mutation vs response</span></span>
<span><span class="va">egfr_response_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">EGFR_Mutation</span>, </span>
<span>                            <span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">egfr_response_table</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">egfr_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">egfr_response_table</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EGFR mutation vs response p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">egfr_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># MSI status vs response</span></span>
<span><span class="va">msi_response_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span>,</span>
<span>                           <span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">msi_response_table</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">msi_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">msi_response_table</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MSI-High vs response p-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">msi_test</span><span class="op">$</span><span class="va">p.value</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="progression-free-survival-analysis">Progression-Free Survival Analysis<a class="anchor" aria-label="anchor" href="#progression-free-survival-analysis"></a>
</h3>
<p>Analyze time-to-progression by biomarker status.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PFS analysis by biomarker groups</span></span>
<span><span class="va">pfs_summary</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">EGFR_Mutation</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    median_pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">PFS_Months</span><span class="op">)</span>,</span>
<span>    progression_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Progression_Event</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"PFS by EGFR Status:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pfs_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MSI status PFS analysis</span></span>
<span><span class="va">msi_pfs_summary</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">MSI_Status</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    median_pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">PFS_Months</span><span class="op">)</span>,</span>
<span>    progression_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Progression_Event</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"PFS by MSI Status:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">msi_pfs_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Survival analysis if survival package available</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"survival"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create survival object</span></span>
<span>  <span class="va">surv_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PFS_Months</span>, </span>
<span>                   <span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Progression_Event</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Kaplan-Meier analysis by EGFR status</span></span>
<span>  <span class="va">km_egfr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="va">surv_obj</span> <span class="op">~</span> <span class="va">EGFR_Mutation</span>, data <span class="op">=</span> <span class="va">precision_oncology_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nKaplan-Meier Analysis - EGFR Status:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">km_egfr</span><span class="op">)</span><span class="op">$</span><span class="va">table</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Log-rank test</span></span>
<span>  <span class="va">logrank_egfr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="va">surv_obj</span> <span class="op">~</span> <span class="va">EGFR_Mutation</span>, data <span class="op">=</span> <span class="va">precision_oncology_data</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-rank test p-value (EGFR):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">logrank_egfr</span><span class="op">$</span><span class="va">chisq</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Cox proportional hazards model</span></span>
<span>  <span class="va">cox_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="va">surv_obj</span> <span class="op">~</span> <span class="va">EGFR_Mutation</span> <span class="op">+</span> <span class="va">MSI_Status</span> <span class="op">+</span> <span class="va">PD_L1_TPS</span> <span class="op">+</span> <span class="va">Age</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">precision_oncology_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nCox Regression Results:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cox_model</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coef"</span>, <span class="st">"exp(coef)"</span>, <span class="st">"Pr(&gt;|z|)"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="companion-diagnostic-development">Companion Diagnostic Development<a class="anchor" aria-label="anchor" href="#companion-diagnostic-development"></a>
</h2>
<div class="section level3">
<h3 id="roc-analysis-for-biomarker-cutpoints">ROC Analysis for Biomarker Cutpoints<a class="anchor" aria-label="anchor" href="#roc-analysis-for-biomarker-cutpoints"></a>
</h3>
<p>Optimize biomarker cutpoints for treatment selection.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ROC analysis for PD-L1 TPS cutpoint optimization</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pROC"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/" class="external-link">pROC</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create binary response outcome</span></span>
<span>  <span class="va">response_binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># ROC analysis for PD-L1 TPS</span></span>
<span>  <span class="va">roc_pdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">response_binary</span>, <span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PD-L1 TPS ROC Analysis:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"AUC:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="va">roc_pdl1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% CI:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ci.auc.html" class="external-link">ci.auc</a></span><span class="op">(</span><span class="va">roc_pdl1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Optimal cutpoint using Youden index</span></span>
<span>  <span class="va">optimal_cutpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/coords.html" class="external-link">coords</a></span><span class="op">(</span><span class="va">roc_pdl1</span>, <span class="st">"best"</span>, ret <span class="op">=</span> <span class="st">"threshold"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal cutpoint (Youden):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">optimal_cutpoint</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Performance at standard cutpoints</span></span>
<span>  <span class="va">cutpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">performance_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Cutpoint <span class="op">=</span> <span class="va">cutpoints</span>,</span>
<span>    Sensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cutpoints</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/coords.html" class="external-link">coords</a></span><span class="op">(</span><span class="va">roc_pdl1</span>, <span class="va">x</span>, ret <span class="op">=</span> <span class="st">"sensitivity"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>,</span>
<span>    Specificity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cutpoints</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/coords.html" class="external-link">coords</a></span><span class="op">(</span><span class="va">roc_pdl1</span>, <span class="va">x</span>, ret <span class="op">=</span> <span class="st">"specificity"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>,</span>
<span>    PPV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cutpoints</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">response_binary</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">response_binary</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tp</span> <span class="op">/</span> <span class="op">(</span><span class="va">tp</span> <span class="op">+</span> <span class="va">fp</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>,</span>
<span>    NPV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cutpoints</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">tn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&lt;</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">response_binary</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&lt;</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">response_binary</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tn</span> <span class="op">/</span> <span class="op">(</span><span class="va">tn</span> <span class="op">+</span> <span class="va">fn</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Performance at Different PD-L1 Cutpoints:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">performance_table</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="biomarker-test-validation">Biomarker Test Validation<a class="anchor" aria-label="anchor" href="#biomarker-test-validation"></a>
</h3>
<p>Assess clinical utility of biomarker testing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clinical utility analysis</span></span>
<span><span class="co"># Calculate number needed to test (NNT) for different biomarkers</span></span>
<span></span>
<span><span class="va">nnt_analysis</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">biomarker_positive</span>, <span class="va">response_rate_positive</span>, <span class="va">response_rate_negative</span>, <span class="va">prevalence</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Response rate difference</span></span>
<span>  <span class="va">response_difference</span> <span class="op">&lt;-</span> <span class="va">response_rate_positive</span> <span class="op">-</span> <span class="va">response_rate_negative</span></span>
<span>  </span>
<span>  <span class="co"># Number needed to treat with biomarker guidance</span></span>
<span>  <span class="va">nnt</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">response_difference</span> <span class="op">*</span> <span class="va">prevalence</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">nnt</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># EGFR mutation NNT</span></span>
<span><span class="va">egfr_prevalence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span></span>
<span><span class="va">egfr_pos_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span><span class="op">[</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">egfr_neg_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span><span class="op">[</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Negative"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">egfr_nnt</span> <span class="op">&lt;-</span> <span class="fu">nnt_analysis</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">egfr_pos_response</span>, <span class="va">egfr_neg_response</span>, <span class="va">egfr_prevalence</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MSI-High NNT</span></span>
<span><span class="va">msi_prevalence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span></span>
<span><span class="va">msi_pos_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span><span class="op">[</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msi_neg_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">Treatment_Response</span><span class="op">[</span><span class="va">precision_oncology_data</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">!=</span> <span class="st">"MSI-High"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msi_nnt</span> <span class="op">&lt;-</span> <span class="fu">nnt_analysis</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">msi_pos_response</span>, <span class="va">msi_neg_response</span>, <span class="va">msi_prevalence</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clinical_utility_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Biomarker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EGFR Mutation"</span>, <span class="st">"MSI-High Status"</span><span class="op">)</span>,</span>
<span>  Prevalence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">egfr_prevalence</span>, <span class="va">msi_prevalence</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>  Response_Rate_Positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">egfr_pos_response</span>, <span class="va">msi_pos_response</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>  Response_Rate_Negative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">egfr_neg_response</span>, <span class="va">msi_neg_response</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>  Number_Needed_to_Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">egfr_nnt</span>, <span class="va">msi_nnt</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Clinical Utility Analysis:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">clinical_utility_table</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="economic-evaluation">Economic Evaluation<a class="anchor" aria-label="anchor" href="#economic-evaluation"></a>
</h2>
<div class="section level3">
<h3 id="cost-effectiveness-analysis">Cost-Effectiveness Analysis<a class="anchor" aria-label="anchor" href="#cost-effectiveness-analysis"></a>
</h3>
<p>Assess economic impact of biomarker-guided therapy.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate treatment costs and outcomes</span></span>
<span><span class="va">precision_oncology_data</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Estimate treatment costs based on therapy type</span></span>
<span>    treatment_cost <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">primary_treatment</span> <span class="op">==</span> <span class="st">"EGFR TKI"</span> <span class="op">~</span> <span class="fl">120000</span>,</span>
<span>      <span class="va">primary_treatment</span> <span class="op">==</span> <span class="st">"HER2-Targeted Therapy"</span> <span class="op">~</span> <span class="fl">150000</span>,</span>
<span>      <span class="va">primary_treatment</span> <span class="op">==</span> <span class="st">"BRAF Inhibitor"</span> <span class="op">~</span> <span class="fl">140000</span>,</span>
<span>      <span class="va">primary_treatment</span> <span class="op">==</span> <span class="st">"ALK Inhibitor"</span> <span class="op">~</span> <span class="fl">160000</span>,</span>
<span>      <span class="va">immunotherapy_candidate</span> <span class="op">==</span> <span class="st">"First-line Immunotherapy"</span> <span class="op">~</span> <span class="fl">180000</span>,</span>
<span>      <span class="va">immunotherapy_candidate</span> <span class="op">==</span> <span class="st">"First-line Anti-PD-1"</span> <span class="op">~</span> <span class="fl">150000</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">80000</span>  <span class="co"># Standard chemotherapy</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Estimate testing costs</span></span>
<span>    testing_cost <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">biomarker_count</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">biomarker_count</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1500</span>,</span>
<span>      <span class="va">biomarker_count</span> <span class="op">&gt;=</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">3000</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Total cost per patient</span></span>
<span>    total_cost <span class="op">=</span> <span class="va">treatment_cost</span> <span class="op">+</span> <span class="va">testing_cost</span>,</span>
<span>    </span>
<span>    <span class="co"># Quality-adjusted life years (QALYs) based on response and survival</span></span>
<span>    qalys <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Treatment_Response</span> <span class="op">==</span> <span class="st">"Complete_Response"</span> <span class="op">~</span> <span class="va">PFS_Months</span> <span class="op">*</span> <span class="fl">0.9</span> <span class="op">/</span> <span class="fl">12</span>,</span>
<span>      <span class="va">Treatment_Response</span> <span class="op">==</span> <span class="st">"Partial_Response"</span> <span class="op">~</span> <span class="va">PFS_Months</span> <span class="op">*</span> <span class="fl">0.8</span> <span class="op">/</span> <span class="fl">12</span>,</span>
<span>      <span class="va">Treatment_Response</span> <span class="op">==</span> <span class="st">"Stable_Disease"</span> <span class="op">~</span> <span class="va">PFS_Months</span> <span class="op">*</span> <span class="fl">0.7</span> <span class="op">/</span> <span class="fl">12</span>,</span>
<span>      <span class="va">Treatment_Response</span> <span class="op">==</span> <span class="st">"Progressive_Disease"</span> <span class="op">~</span> <span class="va">PFS_Months</span> <span class="op">*</span> <span class="fl">0.4</span> <span class="op">/</span> <span class="fl">12</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">PFS_Months</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">/</span> <span class="fl">12</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Cost-effectiveness by biomarker strategy</span></span>
<span><span class="va">cost_effectiveness_summary</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">biomarker_category</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">total_cost</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    mean_qalys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qalys</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    cost_per_qaly <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">total_cost</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qalys</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    response_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Treatment_Response</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Complete_Response"</span>, <span class="st">"Partial_Response"</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cost-Effectiveness by Biomarker Strategy:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cost_effectiveness_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Incremental cost-effectiveness ratio (ICER)</span></span>
<span><span class="va">no_biomarker_cost</span> <span class="op">&lt;-</span> <span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">mean_cost</span><span class="op">[</span><span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">biomarker_category</span> <span class="op">==</span> <span class="st">"No Actionable Biomarkers"</span><span class="op">]</span></span>
<span><span class="va">single_biomarker_cost</span> <span class="op">&lt;-</span> <span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">mean_cost</span><span class="op">[</span><span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">biomarker_category</span> <span class="op">==</span> <span class="st">"Single Biomarker"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">no_biomarker_qaly</span> <span class="op">&lt;-</span> <span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">mean_qalys</span><span class="op">[</span><span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">biomarker_category</span> <span class="op">==</span> <span class="st">"No Actionable Biomarkers"</span><span class="op">]</span></span>
<span><span class="va">single_biomarker_qaly</span> <span class="op">&lt;-</span> <span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">mean_qalys</span><span class="op">[</span><span class="va">cost_effectiveness_summary</span><span class="op">$</span><span class="va">biomarker_category</span> <span class="op">==</span> <span class="st">"Single Biomarker"</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">no_biomarker_cost</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">single_biomarker_cost</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">icer</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">single_biomarker_cost</span> <span class="op">-</span> <span class="va">no_biomarker_cost</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">single_biomarker_qaly</span> <span class="op">-</span> <span class="va">no_biomarker_qaly</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ICER (Single Biomarker vs No Biomarker): $"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">icer</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">" per QALY\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Cost-effectiveness threshold interpretation</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">icer</span> <span class="op">&lt;</span> <span class="fl">50000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Interpretation: Highly cost-effective (&lt; $50,000/QALY)\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">icer</span> <span class="op">&lt;</span> <span class="fl">100000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Interpretation: Cost-effective (&lt; $100,000/QALY)\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Interpretation: Not cost-effective (&gt; $100,000/QALY)\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="clinical-decision-support">Clinical Decision Support<a class="anchor" aria-label="anchor" href="#clinical-decision-support"></a>
</h2>
<div class="section level3">
<h3 id="treatment-selection-dashboard">Treatment Selection Dashboard<a class="anchor" aria-label="anchor" href="#treatment-selection-dashboard"></a>
</h3>
<p>Create a clinical decision support framework.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to generate treatment recommendations</span></span>
<span><span class="va">generate_treatment_recommendation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">patient_data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">recommendations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Check for targetable alterations</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span> <span class="op">&lt;-</span> <span class="st">"EGFR TKI (osimertinib, erlotinib)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">evidence_level</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span> <span class="op">&lt;-</span> <span class="st">"ALK inhibitor (alectinib, crizotinib)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">evidence_level</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span> <span class="op">&lt;-</span> <span class="st">"HER2-targeted therapy (trastuzumab + pertuzumab)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">evidence_level</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">BRAF_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span> <span class="op">&lt;-</span> <span class="st">"BRAF inhibitor (vemurafenib + cobimetinib)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">evidence_level</span> <span class="op">&lt;-</span> <span class="st">"1B"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check for immunotherapy eligibility</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span> <span class="op">&lt;-</span> <span class="st">"Anti-PD-1 monotherapy (pembrolizumab)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immuno_evidence</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span> <span class="op">&lt;-</span> <span class="st">"Anti-PD-1 monotherapy (pembrolizumab)"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immuno_evidence</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">patient_data</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span> <span class="op">&lt;-</span> <span class="st">"Combination immunotherapy"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">immuno_evidence</span> <span class="op">&lt;-</span> <span class="st">"1B"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Default to chemotherapy if no actionable alterations</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">default</span> <span class="op">&lt;-</span> <span class="st">"Standard chemotherapy"</span></span>
<span>    <span class="va">recommendations</span><span class="op">$</span><span class="va">default_evidence</span> <span class="op">&lt;-</span> <span class="st">"1A"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example patient recommendations</span></span>
<span><span class="va">example_patients</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Treatment Recommendations for Sample Patients:\n\n"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">example_patients</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">patient</span> <span class="op">&lt;-</span> <span class="va">example_patients</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">recommendations</span> <span class="op">&lt;-</span> <span class="fu">generate_treatment_recommendation</span><span class="op">(</span><span class="va">patient</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Patient"</span>, <span class="va">patient</span><span class="op">$</span><span class="va">Patient_ID</span>, <span class="st">"("</span>, <span class="va">patient</span><span class="op">$</span><span class="va">Tumor_Type</span>, <span class="st">"):\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Age:"</span>, <span class="va">patient</span><span class="op">$</span><span class="va">Age</span>, <span class="st">", Grade:"</span>, <span class="va">patient</span><span class="op">$</span><span class="va">Grade</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Print biomarker status</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Biomarkers: "</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">EGFR_Mutation</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EGFR+ "</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">ALK_Fusion</span> <span class="op">==</span> <span class="st">"Positive"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ALK+ "</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">HER2_FISH_Status</span> <span class="op">==</span> <span class="st">"Amplified"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HER2+ "</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">MSI_Status</span> <span class="op">==</span> <span class="st">"MSI-High"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MSI-H "</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">patient</span><span class="op">$</span><span class="va">PD_L1_TPS</span> <span class="op">&gt;=</span> <span class="fl">50</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PD-L1 high "</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Print recommendations</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Recommended:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">targeted</span>, <span class="st">"(Evidence:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">evidence_level</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alternative:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">immunotherapy</span>, <span class="st">"(Evidence:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">immuno_evidence</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">recommendations</span><span class="op">$</span><span class="va">default</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Recommended:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">default</span>, <span class="st">"(Evidence:"</span>, <span class="va">recommendations</span><span class="op">$</span><span class="va">default_evidence</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Actual Response:"</span>, <span class="va">patient</span><span class="op">$</span><span class="va">Treatment_Response</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PFS:"</span>, <span class="va">patient</span><span class="op">$</span><span class="va">PFS_Months</span>, <span class="st">"months\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quality-assurance-in-precision-oncology">Quality Assurance in Precision Oncology<a class="anchor" aria-label="anchor" href="#quality-assurance-in-precision-oncology"></a>
</h2>
<div class="section level3">
<h3 id="biomarker-testing-quality-metrics">Biomarker Testing Quality Metrics<a class="anchor" aria-label="anchor" href="#biomarker-testing-quality-metrics"></a>
</h3>
<p>Monitor quality of molecular testing programs.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate quality metrics for biomarker testing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">quality_metrics</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Simulate testing quality metrics</span></span>
<span>    turnaround_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    test_success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Success"</span>, <span class="st">"Failed"</span>, <span class="st">"Repeat"</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                              prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    reporting_clarity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clear"</span>, <span class="st">"Adequate"</span>, <span class="st">"Unclear"</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                              prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tumor_Type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n_tests <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean_tat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">turnaround_time</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_success_rate</span> <span class="op">==</span> <span class="st">"Success"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    clear_reporting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">reporting_clarity</span> <span class="op">==</span> <span class="st">"Clear"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    actionable_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">biomarker_count</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">'drop'</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n_tests</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Quality Metrics by Tumor Type:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">quality_metrics</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overall quality dashboard</span></span>
<span><span class="va">overall_quality</span> <span class="op">&lt;-</span> <span class="va">precision_oncology_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    total_patients <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    actionable_biomarker_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">biomarker_count</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    multiple_biomarker_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">biomarker_count</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    targeted_therapy_eligible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">primary_treatment</span> <span class="op">!=</span> <span class="st">"Standard Chemotherapy"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    immunotherapy_eligible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">immunotherapy_candidate</span> <span class="op">!=</span> <span class="st">"Chemotherapy First"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overall Precision Oncology Quality Dashboard:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total patients tested:"</span>, <span class="va">overall_quality</span><span class="op">$</span><span class="va">total_patients</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Actionable biomarker rate:"</span>, <span class="va">overall_quality</span><span class="op">$</span><span class="va">actionable_biomarker_rate</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Multiple biomarker rate:"</span>, <span class="va">overall_quality</span><span class="op">$</span><span class="va">multiple_biomarker_rate</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Targeted therapy eligible:"</span>, <span class="va">overall_quality</span><span class="op">$</span><span class="va">targeted_therapy_eligible</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Immunotherapy eligible:"</span>, <span class="va">overall_quality</span><span class="op">$</span><span class="va">immunotherapy_eligible</span>, <span class="st">"%\n"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This comprehensive precision oncology analysis demonstrates the
complexity and clinical value of biomarker-guided cancer care. Key
findings include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>High Actionable Rate</strong>: &gt;60% of patients have
actionable biomarkers</li>
<li>
<strong>Improved Outcomes</strong>: Biomarker-positive patients show
better response rates</li>
<li>
<strong>Cost-Effectiveness</strong>: Targeted therapy provides
favorable cost-utility ratios</li>
<li>
<strong>Clinical Utility</strong>: Significant survival benefit with
biomarker-guided treatment</li>
<li>
<strong>Quality Assurance</strong>: Robust QC metrics ensure
reliable testing</li>
</ol>
<div class="section level3">
<h3 id="implementation-recommendations">Implementation Recommendations<a class="anchor" aria-label="anchor" href="#implementation-recommendations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Comprehensive Testing</strong>: Implement broad molecular
profiling panels</li>
<li>
<strong>Rapid Turnaround</strong>: Achieve &lt;7-day reporting for
treatment decisions</li>
<li>
<strong>Clinical Integration</strong>: Embed recommendations in
electronic health records</li>
<li>
<strong>Outcome Tracking</strong>: Monitor real-world effectiveness
of biomarker strategies</li>
<li>
<strong>Cost Monitoring</strong>: Evaluate economic impact and
adjust coverage policies</li>
</ol>
</div>
<div class="section level3">
<h3 id="future-directions">Future Directions<a class="anchor" aria-label="anchor" href="#future-directions"></a>
</h3>
<ul>
<li>
<strong>Liquid Biopsy Integration</strong>: Circulating tumor DNA
monitoring</li>
<li>
<strong>Artificial Intelligence</strong>: Machine learning for
biomarker interpretation</li>
<li>
<strong>Real-World Evidence</strong>: Population-based outcome
studies</li>
<li>
<strong>Combination Biomarkers</strong>: Multi-analyte predictive
models</li>
<li>
<strong>Resistance Monitoring</strong>: Dynamic biomarker assessment
during treatment</li>
</ul>
<hr>
<p><em>This vignette demonstrates advanced precision oncology workflows
using the ClinicoPath suite. For additional biomarker analysis examples,
explore related vignettes on ROC analysis and survival
analysis.</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Serdar Balci.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
