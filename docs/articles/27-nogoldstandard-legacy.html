<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Diagnostic Tests without a Gold Standard • meddecide</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Diagnostic Tests without a Gold Standard">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meddecide</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-introduction.html">MedDecide 01: Introduction to Medical Decision Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/02-comprehensive-guide.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-advanced-features.html">Advanced Features in Interrater Agreement Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-analysis.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/03-roc-analysis.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/04-decision-tree-guide.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/05-decision-tree-analysis.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/06-decision-tree-vs-markov.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/06-jamovi-workflow-examples.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/07-bayesian-decision-curve-analysis.html">Bayesian Decision Curve Analysis - Advanced Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/07-decision-trees.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/07-kappasizeci-comprehensive.html">Sample Size Calculations for Interobserver Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/08-decision-panel-clinical.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/08-kappasizefixedn-comprehensive.html">Complete Guide to kappasizefixedn: Fixed Sample Size Kappa Power Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/09-decision-panel-advanced.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/09-kappasizepower-comprehensive.html">Complete Guide to kappasizepower: Power Analysis for Inter-rater Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/10-decision-panel-optimization.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/11-precision-oncology.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/12-nogoldstandard.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/13-diagnostic-tests.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/14-diagnostic-style-quick-guide.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/15-diagnostic-style-clustering.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/16-use-in-r.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/17-introduction-legacy.html">meddecide: Introduction to Medical Decision Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/18-roc-analysis-legacy.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/19-decisionpanel-advanced-legacy.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/20-decisionpanel-clinical-legacy.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/21-decisionpanel-optimization-legacy.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/22-diagnostic-style-clustering-legacy.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/23-diagnostic-style-quick-guide-legacy.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/24-agreement-analysis-legacy.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/25-diagnostic-tests-legacy.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/25-jamovi-workflow-examples-legacy.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/26-medical-decision-tree-guide-legacy.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/27-nogoldstandard-legacy.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/28-decision-tree-examples-legacy.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/29-decision-tree-vs-markov-analysis-legacy.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/30-decisiontree-analysis-vignette-legacy.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/31-precision-oncology-biomarkers-legacy.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/32-vignettes-legacy.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/33-use-in-r-legacy.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/34-cotest-analysis.html">Co-Testing Analysis: Combining Diagnostic Tests for Better Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/35-screening-calculator-comprehensive.html">Screening Test Calculator: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/36-sequential-testing-comprehensive.html">Sequential Testing Analysis: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/38-modelbuilder-comprehensive.html">Clinical Prediction Model Builder</a></li>
    <li><a class="dropdown-item" href="../articles/decisionpanel_threshold_calculator.html">Decision Panel Threshold Calculator (p_t)</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-01-oncodatasets-examples.html">meddecide: Medical Decision Analysis with Oncology Data</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-05-decisiongraph-comprehensive.html">Decision Tree Analysis with decisiongraph: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-09-digital-pathology-validation.html">Digital Pathology Validation: Agreement Analysis and Modality Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-15-multiclass-diagnostics-comprehensive.html">Multi-class Diagnostic Performance Evaluation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyzing Diagnostic Tests without a Gold Standard</h1>
                        <h4 data-toc-skip class="author">ClinicoPath
Development Team</h4>
            
            <h4 data-toc-skip class="date">2025-10-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/27-nogoldstandard-legacy.Rmd" class="external-link"><code>vignettes/27-nogoldstandard-legacy.Rmd</code></a></small>
      <div class="d-none name"><code>27-nogoldstandard-legacy.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In clinical practice and research, evaluating diagnostic test
performance typically requires a “gold standard” reference test to
determine the true disease status. However, in many situations, a
perfect gold standard test is unavailable, expensive, invasive, or
unethical to perform. The <code>nogoldstandard</code> module in the
ClinicoPath package provides methods for analyzing the performance of
multiple diagnostic tests without requiring a gold standard
reference.</p>
<p>This vignette demonstrates how to use the <code>nogoldstandard</code>
module to:</p>
<ol style="list-style-type: decimal">
<li>Estimate disease prevalence</li>
<li>Calculate sensitivity and specificity for multiple tests</li>
<li>Compute confidence intervals using bootstrap methods</li>
<li>Visualize test agreement patterns</li>
</ol>
<div class="section level3">
<h3 id="why-analyze-tests-without-a-gold-standard">Why analyze tests without a gold standard?<a class="anchor" aria-label="anchor" href="#why-analyze-tests-without-a-gold-standard"></a>
</h3>
<p>When no perfect reference test exists, researchers typically face
challenging options:</p>
<ul>
<li>Use an imperfect reference (introducing verification bias)</li>
<li>Employ composite reference standards (potentially arbitrary)</li>
<li>Exclude subjects without verification (introducing selection
bias)</li>
</ul>
<p>Statistical methods for “no gold standard” analysis offer an
alternative approach, allowing estimation of test performance metrics by
using the patterns of agreement and disagreement among multiple
imperfect tests.</p>
</div>
</div>
<div class="section level2">
<h2 id="methods-overview">Methods Overview<a class="anchor" aria-label="anchor" href="#methods-overview"></a>
</h2>
<p>The <code>nogoldstandard</code> module implements five different
approaches:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Latent Class Analysis (LCA)</strong>: Assumes disease
status is an unobserved (latent) variable and models the relationship
between this latent variable and the observed test results.</p></li>
<li><p><strong>Composite Reference</strong>: Creates a reference
standard by considering the majority result across all tests as the
“true” status.</p></li>
<li><p><strong>All Tests Positive</strong>: Considers disease present
only when all tests are positive (high specificity approach).</p></li>
<li><p><strong>Any Test Positive</strong>: Considers disease present
when any test is positive (high sensitivity approach).</p></li>
<li><p><strong>Bayesian Analysis</strong>: Uses prior distributions and
an EM algorithm to estimate parameters, potentially incorporating prior
knowledge.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>nogoldstandard</code> module is part of the ClinicoPath
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ClinicoPath"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or the development version</span></span>
<span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"sbalci/ClinicoPath"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>Let’s create a sample dataset with 4 diagnostic tests performed on
200 patients:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>  <span class="co"># Number of patients</span></span>
<span></span>
<span><span class="co"># True disease status (unknown in practice)</span></span>
<span><span class="va">true_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span>  <span class="co"># 30% prevalence</span></span>
<span></span>
<span><span class="co"># Create 4 imperfect tests with different sensitivity/specificity</span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">true_status</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.90</span><span class="op">)</span>,  <span class="co"># 90% sensitivity</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 90% specificity</span></span>
<span></span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">true_status</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.75</span><span class="op">)</span>,  <span class="co"># 75% sensitivity</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 95% specificity</span></span>
<span></span>
<span><span class="va">test3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">true_status</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.85</span><span class="op">)</span>,  <span class="co"># 85% sensitivity</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 85% specificity</span></span>
<span></span>
<span><span class="va">test4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">true_status</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.70</span><span class="op">)</span>,  <span class="co"># 70% sensitivity</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 95% specificity</span></span>
<span></span>
<span><span class="co"># Convert to categorical format</span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">test1</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">test2</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">test3</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">test4</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"pos"</span>, <span class="st">"neg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  caseID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>,</span>
<span>  test1 <span class="op">=</span> <span class="va">test1</span>,</span>
<span>  test2 <span class="op">=</span> <span class="va">test2</span>,</span>
<span>  test3 <span class="op">=</span> <span class="va">test3</span>,</span>
<span>  test4 <span class="op">=</span> <span class="va">test4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-the-analysis">Running the Analysis<a class="anchor" aria-label="anchor" href="#running-the-analysis"></a>
</h3>
<p>Now let’s analyze this data using the Latent Class Analysis
method:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nogoldstandard.html">nogoldstandard</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  test1 <span class="op">=</span> <span class="st">"test1"</span>,</span>
<span>  test1Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test2 <span class="op">=</span> <span class="st">"test2"</span>,</span>
<span>  test2Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test3 <span class="op">=</span> <span class="st">"test3"</span>,</span>
<span>  test3Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test4 <span class="op">=</span> <span class="st">"test4"</span>,</span>
<span>  test4Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test5 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"latent_class"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The result will contain:</p>
<ol style="list-style-type: decimal">
<li>Estimated disease prevalence</li>
<li>Sensitivity and specificity for each test</li>
<li>Test agreement matrix visualization</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h2>
<p>One of the key features of the <code>nogoldstandard</code> module is
the ability to compute confidence intervals using bootstrap resampling.
This provides a measure of uncertainty around the estimated
parameters.</p>
<div class="section level3">
<h3 id="understanding-bootstrap-in-nogoldstandard-analysis">Understanding Bootstrap in NoGoldStandard Analysis<a class="anchor" aria-label="anchor" href="#understanding-bootstrap-in-nogoldstandard-analysis"></a>
</h3>
<p>Bootstrap resampling involves:</p>
<ol style="list-style-type: decimal">
<li>Randomly selecting observations from the original dataset with
replacement</li>
<li>Running the selected analysis method on each resampled dataset</li>
<li>Computing the parameter of interest (prevalence, sensitivity,
specificity)</li>
<li>Repeating steps 1-3 many times to build a distribution</li>
<li>Using the distribution to calculate confidence intervals</li>
</ol>
</div>
<div class="section level3">
<h3 id="enabling-bootstrap-with-progress-reporting">Enabling Bootstrap with Progress Reporting<a class="anchor" aria-label="anchor" href="#enabling-bootstrap-with-progress-reporting"></a>
</h3>
<p>The enhanced version of the <code>nogoldstandard</code> module
includes detailed progress reporting during bootstrap analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_with_ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nogoldstandard.html">nogoldstandard</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  test1 <span class="op">=</span> <span class="st">"test1"</span>,</span>
<span>  test1Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test2 <span class="op">=</span> <span class="st">"test2"</span>,</span>
<span>  test2Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test3 <span class="op">=</span> <span class="st">"test3"</span>,</span>
<span>  test3Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  test4 <span class="op">=</span> <span class="st">"test4"</span>,</span>
<span>  test4Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"latent_class"</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># Enable bootstrap</span></span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Number of bootstrap samples</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>          <span class="co"># For 95% confidence intervals</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>When running this analysis, you’ll see progress updates in the
console:</p>
<pre><code>=== Bootstrap Analysis ===
Starting bootstrap with 1000 iterations for latent_class method
Estimating confidence intervals for prevalence

  50/1000 (5.0%) - 50 successful, 0 errors - 12.3 sec elapsed, ~234.7 sec remaining
  100/1000 (10.0%) - 100 successful, 0 errors - 24.8 sec elapsed, ~223.2 sec remaining
  ...
  950/1000 (95.0%) - 942 successful, 8 errors - 236.5 sec elapsed, ~12.5 sec remaining
  1000/1000 (100.0%) - 991 successful, 9 errors - 249.3 sec elapsed, ~0.0 sec remaining

=== Bootstrap Complete ===
Total time: 249.3 seconds (4.01 iterations/sec)
Successful iterations: 991 (99.1%)
Failed iterations: 9 (0.9%)
Confidence interval (95.0%): [0.2145, 0.2987]</code></pre>
</div>
<div class="section level3">
<h3 id="expected-duration-for-bootstrap-analysis">Expected Duration for Bootstrap Analysis<a class="anchor" aria-label="anchor" href="#expected-duration-for-bootstrap-analysis"></a>
</h3>
<p>The time required for bootstrap analysis depends on several
factors:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="23%">
<col width="26%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th>Dataset Size</th>
<th>100 Iterations</th>
<th>1,000 Iterations</th>
<th>10,000 Iterations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Small (&lt;100 obs, 2-3 tests)</td>
<td>5-30 sec</td>
<td>30 sec - 5 min</td>
<td>5-50 min</td>
</tr>
<tr class="even">
<td>Medium (100-1,000 obs, 3-4 tests)</td>
<td>30 sec - 2 min</td>
<td>3-20 min</td>
<td>30 min - 3 hrs</td>
</tr>
<tr class="odd">
<td>Large (&gt;1,000 obs, 5 tests)</td>
<td>1-5 min</td>
<td>10-60 min</td>
<td>1-8 hrs</td>
</tr>
</tbody>
</table>
<p>The analysis method also affects duration: - Latent Class Analysis:
Slowest (multiple model fitting attempts) - Bayesian Analysis: Moderate
(iterative EM algorithm) - Composite/All/Any Test: Fastest (simple
calculations)</p>
</div>
<div class="section level3">
<h3 id="recommended-bootstrap-iterations">Recommended Bootstrap Iterations<a class="anchor" aria-label="anchor" href="#recommended-bootstrap-iterations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>For Quick Exploration</strong>: 100-500 bootstrap
samples</li>
<li>
<strong>For Publication-Quality Results</strong>: 1,000-2,000
bootstrap samples</li>
<li>
<strong>For Critical Applications</strong>: 5,000-10,000 bootstrap
samples</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="comparing-different-methods">Comparing Different Methods<a class="anchor" aria-label="anchor" href="#comparing-different-methods"></a>
</h2>
<p>Let’s compare the results from different analysis methods:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run analysis with each method</span></span>
<span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"latent_class"</span>, <span class="st">"composite"</span>, <span class="st">"all_positive"</span>, <span class="st">"any_positive"</span>, <span class="st">"bayesian"</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="va">methods</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">method</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nogoldstandard.html">nogoldstandard</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data</span>,</span>
<span>    test1 <span class="op">=</span> <span class="st">"test1"</span>,</span>
<span>    test1Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>    test2 <span class="op">=</span> <span class="st">"test2"</span>,</span>
<span>    test2Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>    test3 <span class="op">=</span> <span class="st">"test3"</span>,</span>
<span>    test3Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>    test4 <span class="op">=</span> <span class="st">"test4"</span>,</span>
<span>    test4Positive <span class="op">=</span> <span class="st">"pos"</span>,</span>
<span>    method <span class="op">=</span> <span class="va">method</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Extract prevalence estimates</span></span>
<span><span class="va">prevalence_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">prevalence</span><span class="op">$</span><span class="fu">asDF</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">prevalence_estimates</span><span class="op">)</span></span></code></pre></div>
<p>Different methods may produce different estimates. In general:</p>
<ul>
<li>
<strong>Latent Class Analysis</strong>: Often considered the most
theoretically sound but requires assumptions about conditional
independence</li>
<li>
<strong>Composite Reference</strong>: Practical but can be biased
toward majority</li>
<li>
<strong>All Tests Positive</strong>: Conservative approach (low
prevalence, high test specificity)</li>
<li>
<strong>Any Test Positive</strong>: Liberal approach (high
prevalence, high test sensitivity)</li>
<li>
<strong>Bayesian Analysis</strong>: Flexible and can incorporate
prior knowledge, but requires careful prior specification</li>
</ul>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<div class="section level3">
<h3 id="disease-prevalence">Disease Prevalence<a class="anchor" aria-label="anchor" href="#disease-prevalence"></a>
</h3>
<p>The estimated prevalence represents the proportion of the population
expected to have the disease. Different methods will yield different
prevalence estimates:</p>
<ul>
<li>
<strong>All Tests Positive</strong>: Typically produces the lowest
prevalence estimate</li>
<li>
<strong>Any Test Positive</strong>: Typically produces the highest
prevalence estimate</li>
<li>
<strong>Latent Class Analysis</strong>: Usually produces an
intermediate estimate</li>
</ul>
</div>
<div class="section level3">
<h3 id="test-performance">Test Performance<a class="anchor" aria-label="anchor" href="#test-performance"></a>
</h3>
<p>For each test, the module estimates:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sensitivity</strong>: The probability of a positive test
result in patients with the disease</li>
<li>
<strong>Specificity</strong>: The probability of a negative test
result in patients without the disease</li>
</ol>
<p>Sensitivity and specificity can be used to:</p>
<ul>
<li>Compare test performance</li>
<li>Inform test selection decisions</li>
<li>Design optimal testing strategies</li>
</ul>
</div>
<div class="section level3">
<h3 id="agreement-plot">Agreement Plot<a class="anchor" aria-label="anchor" href="#agreement-plot"></a>
</h3>
<p>The test agreement plot shows the proportion of agreement between
each pair of tests. This visualization helps identify:</p>
<ul>
<li>Tests that frequently agree/disagree</li>
<li>Potential conditional dependence between tests</li>
<li>Clusters of similar tests</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="advanced-topics">Advanced Topics<a class="anchor" aria-label="anchor" href="#advanced-topics"></a>
</h2>
<div class="section level3">
<h3 id="handling-missing-data">Handling Missing Data<a class="anchor" aria-label="anchor" href="#handling-missing-data"></a>
</h3>
<p>The <code>nogoldstandard</code> module can handle missing test
results. The enhanced implementation:</p>
<ul>
<li>Skips missing values when calculating agreement</li>
<li>Uses available data for each test when estimating parameters</li>
<li>Properly accounts for missing data in bootstrap resampling</li>
</ul>
</div>
<div class="section level3">
<h3 id="bayesian-analysis-with-prior-information">Bayesian Analysis with Prior Information<a class="anchor" aria-label="anchor" href="#bayesian-analysis-with-prior-information"></a>
</h3>
<p>If you have prior knowledge about disease prevalence or test
characteristics, the Bayesian method can incorporate this
information:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of Bayesian analysis with informative priors would be shown here</span></span>
<span><span class="co"># This feature would require customization of the Bayesian method code</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conditional-dependence">Conditional Dependence<a class="anchor" aria-label="anchor" href="#conditional-dependence"></a>
</h3>
<p>The default Latent Class Analysis assumes conditional independence
between tests given the true disease status. If this assumption is
violated, results may be biased. Extensions to handle conditional
dependence are:</p>
<ul>
<li>Including direct test-to-test associations in the model</li>
<li>Using more than two latent classes</li>
<li>Applying hierarchical latent class models</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="recommendations-for-practice">Recommendations for Practice<a class="anchor" aria-label="anchor" href="#recommendations-for-practice"></a>
</h2>
<div class="section level3">
<h3 id="method-selection">Method Selection<a class="anchor" aria-label="anchor" href="#method-selection"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Start with Latent Class Analysis</strong> as the primary
method</li>
<li>
<strong>Compare with composite methods</strong> to check
robustness</li>
<li>
<strong>Consider Bayesian analysis</strong> if prior information is
available</li>
<li>
<strong>Report results from multiple methods</strong> for
transparency</li>
</ol>
</div>
<div class="section level3">
<h3 id="bootstrap-settings">Bootstrap Settings<a class="anchor" aria-label="anchor" href="#bootstrap-settings"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use at least 1,000 bootstrap iterations for published results</li>
<li>For time-consuming methods (LCA), start with 100 iterations to check
feasibility</li>
<li>Monitor progress with the enhanced bootstrap implementation</li>
<li>Report both point estimates and confidence intervals</li>
</ol>
</div>
<div class="section level3">
<h3 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h3>
<p>When possible, validate results against:</p>
<ol style="list-style-type: decimal">
<li>External validation data</li>
<li>Follow-up studies</li>
<li>Alternative gold standard tests on a subset of patients</li>
<li>Results from literature or clinical expertise</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="technical-implementation">Technical Implementation<a class="anchor" aria-label="anchor" href="#technical-implementation"></a>
</h2>
<div class="section level3">
<h3 id="the-enhanced-bootstrap-function">The Enhanced Bootstrap Function<a class="anchor" aria-label="anchor" href="#the-enhanced-bootstrap-function"></a>
</h3>
<p>Below is the implementation of the bootstrap function with progress
reporting:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.calculateBootstrapCI</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">method</span>, <span class="va">nboot</span>, <span class="va">alpha</span>, <span class="va">type</span>, <span class="va">test_index</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simple bootstrap implementation with progress indicators</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="va">boot_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">nboot</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Show starting message</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"\n=== Bootstrap Analysis ==="</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Starting bootstrap with %d iterations for %s method"</span>, <span class="va">nboot</span>, <span class="va">method</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Estimating confidence intervals for %s"</span>, <span class="va">type</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">test_index</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Test index: %d"</span>, <span class="va">test_index</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Progress tracking variables</span></span>
<span>    <span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">last_update</span> <span class="op">&lt;-</span> <span class="va">start_time</span></span>
<span>    <span class="va">update_interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">nboot</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Update ~20 times during process</span></span>
<span>    <span class="va">success_count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">error_count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nboot</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Resample data</span></span>
<span>        <span class="va">boot_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">boot_data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">boot_indices</span>, <span class="op">]</span></span>
<span>        </span>
<span>        <span class="co"># Run analysis on bootstrap sample</span></span>
<span>        <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"latent_class"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">.runLCA</span><span class="op">(</span><span class="va">boot_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"composite"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">.runComposite</span><span class="op">(</span><span class="va">boot_data</span><span class="op">)</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"all_positive"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">.runAllPositive</span><span class="op">(</span><span class="va">boot_data</span><span class="op">)</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"any_positive"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">.runAnyPositive</span><span class="op">(</span><span class="va">boot_data</span><span class="op">)</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"bayesian"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">.runBayesian</span><span class="op">(</span><span class="va">boot_data</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>            <span class="va">success_count</span> <span class="op">&lt;-</span> <span class="va">success_count</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="co"># Count errors but continue bootstrap</span></span>
<span>            <span class="va">error_count</span> <span class="op">&lt;-</span> <span class="va">error_count</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="co"># Extract relevant statistic</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"prevalence"</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_results</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">boot_result</span><span class="op">$</span><span class="va">prevalence</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sensitivity"</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">test_index</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_results</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">boot_result</span><span class="op">$</span><span class="va">sensitivities</span><span class="op">[</span><span class="va">test_index</span><span class="op">]</span></span>
<span>            <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"specificity"</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">test_index</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">boot_results</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">boot_result</span><span class="op">$</span><span class="va">specificities</span><span class="op">[</span><span class="va">test_index</span><span class="op">]</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">boot_results</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="co"># Show progress updates</span></span>
<span>        <span class="va">current_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">b</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="va">update_interval</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span> <span class="va">b</span> <span class="op">==</span> <span class="va">nboot</span> <span class="op">||</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">current_time</span>, <span class="va">last_update</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">elapsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">current_time</span>, <span class="va">start_time</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">percent_done</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">/</span> <span class="va">nboot</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>            <span class="va">est_total</span> <span class="op">&lt;-</span> <span class="va">elapsed</span> <span class="op">/</span> <span class="va">percent_done</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>            <span class="va">est_remaining</span> <span class="op">&lt;-</span> <span class="va">est_total</span> <span class="op">-</span> <span class="va">elapsed</span></span>
<span>            </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %d/%d (%.1f%%) - %d successful, %d errors - %.1f sec elapsed, ~%.1f sec remaining"</span>, </span>
<span>                          <span class="va">b</span>, <span class="va">nboot</span>, <span class="va">percent_done</span>, <span class="va">success_count</span>, <span class="va">error_count</span>,</span>
<span>                          <span class="va">elapsed</span>, <span class="va">est_remaining</span><span class="op">)</span><span class="op">)</span></span>
<span>            </span>
<span>            <span class="va">last_update</span> <span class="op">&lt;-</span> <span class="va">current_time</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Show final statistics</span></span>
<span>    <span class="va">total_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">start_time</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"\n=== Bootstrap Complete ==="</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Total time: %.1f seconds (%.2f iterations/sec)"</span>, </span>
<span>                  <span class="va">total_time</span>, <span class="va">nboot</span><span class="op">/</span><span class="va">total_time</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Successful iterations: %d (%.1f%%)"</span>, </span>
<span>                  <span class="va">success_count</span>, <span class="va">success_count</span><span class="op">/</span><span class="va">nboot</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Failed iterations: %d (%.1f%%)"</span>, </span>
<span>                  <span class="va">error_count</span>, <span class="va">error_count</span><span class="op">/</span><span class="va">nboot</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Calculate percentile CI</span></span>
<span>    <span class="va">boot_results</span> <span class="op">&lt;-</span> <span class="va">boot_results</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">boot_results</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">boot_results</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">boot_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Confidence interval (%.1f%%): [%.4f, %.4f]"</span>, </span>
<span>                      <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, upper <span class="op">=</span> <span class="va">ci</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"WARNING: No valid bootstrap results obtained. Returning NA."</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="cn">NA</span>, upper <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Hui SL, Walter SD. Estimating the error rates of diagnostic
tests. Biometrics. 1980;36(1):167-171.</p></li>
<li><p>Joseph L, Gyorkos TW, Coupal L. Bayesian estimation of disease
prevalence and the parameters of diagnostic tests in the absence of a
gold standard. Am J Epidemiol. 1995;141(3):263-272.</p></li>
<li><p>Albert PS, Dodd LE. A cautionary note on the robustness of latent
class models for estimating diagnostic error without a gold standard.
Biometrics. 2004;60(2):427-435.</p></li>
<li><p>Collins J, Huynh M. Estimation of diagnostic test accuracy
without full verification: a review of latent class methods. Stat Med.
2014;33(24):4141-4169.</p></li>
<li><p>Dendukuri N, Joseph L. Bayesian approaches to modeling the
conditional dependence between multiple diagnostic tests. Biometrics.
2001;57(1):158-167.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Serdar Balci.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
