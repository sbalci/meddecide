<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inter-Rater Agreement and Reliability Analysis in Pathology â€¢ meddecide</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inter-Rater Agreement and Reliability Analysis in Pathology">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meddecide</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-introduction.html">MedDecide 01: Introduction to Medical Decision Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/02-comprehensive-guide.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-advanced-features.html">Advanced Features in Interrater Agreement Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/03-agreement-analysis.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/03-roc-analysis.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/04-decision-tree-guide.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/05-decision-tree-analysis.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/06-decision-tree-vs-markov.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/06-jamovi-workflow-examples.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/07-bayesian-decision-curve-analysis.html">Bayesian Decision Curve Analysis - Advanced Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/07-decision-trees.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/07-kappasizeci-comprehensive.html">Sample Size Calculations for Interobserver Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/08-decision-panel-clinical.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/08-kappasizefixedn-comprehensive.html">Complete Guide to kappasizefixedn: Fixed Sample Size Kappa Power Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/09-decision-panel-advanced.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/09-kappasizepower-comprehensive.html">Complete Guide to kappasizepower: Power Analysis for Inter-rater Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/10-decision-panel-optimization.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/11-precision-oncology.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/12-nogoldstandard.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/13-diagnostic-tests.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/14-diagnostic-style-quick-guide.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/15-diagnostic-style-clustering.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/16-use-in-r.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/17-introduction-legacy.html">meddecide: Introduction to Medical Decision Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/18-roc-analysis-legacy.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/19-decisionpanel-advanced-legacy.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/20-decisionpanel-clinical-legacy.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/21-decisionpanel-optimization-legacy.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/22-diagnostic-style-clustering-legacy.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/23-diagnostic-style-quick-guide-legacy.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/24-agreement-analysis-legacy.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/25-diagnostic-tests-legacy.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/25-jamovi-workflow-examples-legacy.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/26-medical-decision-tree-guide-legacy.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/27-nogoldstandard-legacy.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/28-decision-tree-examples-legacy.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/29-decision-tree-vs-markov-analysis-legacy.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/30-decisiontree-analysis-vignette-legacy.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/31-precision-oncology-biomarkers-legacy.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/32-vignettes-legacy.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/33-use-in-r-legacy.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/34-cotest-analysis.html">Co-Testing Analysis: Combining Diagnostic Tests for Better Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/35-screening-calculator-comprehensive.html">Screening Test Calculator: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/36-sequential-testing-comprehensive.html">Sequential Testing Analysis: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/38-modelbuilder-comprehensive.html">Clinical Prediction Model Builder</a></li>
    <li><a class="dropdown-item" href="../articles/decisionpanel_threshold_calculator.html">Decision Panel Threshold Calculator (p_t)</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-01-oncodatasets-examples.html">meddecide: Medical Decision Analysis with Oncology Data</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-05-decisiongraph-comprehensive.html">Decision Tree Analysis with decisiongraph: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-09-digital-pathology-validation.html">Digital Pathology Validation: Agreement Analysis and Modality Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-15-multiclass-diagnostics-comprehensive.html">Multi-class Diagnostic Performance Evaluation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Inter-Rater Agreement and Reliability Analysis in Pathology</h1>
                        <h4 data-toc-skip class="author">ClinicoPath
Development Team</h4>
            
            <h4 data-toc-skip class="date">2025-10-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/03-agreement-analysis.Rmd" class="external-link"><code>vignettes/03-agreement-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>03-agreement-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Inter-rater agreement and reliability analysis are fundamental to
pathology practice, quality assurance, and research. This comprehensive
guide covers agreement analysis for pathologists, from basic Cohenâ€™s
kappa to advanced methods for complex study designs.</p>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Understand types of agreement measures and their appropriate
use</li>
<li>Master interpretation of kappa statistics in pathological
contexts</li>
<li>Learn to design and power agreement studies</li>
<li>Apply agreement analysis to different pathological scenarios</li>
<li>Implement quality assurance programs using agreement metrics</li>
</ul>
<div class="section level3">
<h3 id="clinical-applications-in-pathology">Clinical Applications in Pathology<a class="anchor" aria-label="anchor" href="#clinical-applications-in-pathology"></a>
</h3>
<p>Agreement analysis is essential for:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Diagnostic Consistency</strong>: Evaluating
inter-pathologist agreement on diagnoses</li>
<li>
<strong>Biomarker Scoring</strong>: Assessing concordance in IHC,
FISH, and molecular markers</li>
<li>
<strong>Grading Systems</strong>: Validating tumor grading and
staging protocols</li>
<li>
<strong>Digital Pathology</strong>: Comparing traditional
vs.Â digital diagnosis</li>
<li>
<strong>Training Programs</strong>: Monitoring resident and fellow
progress</li>
<li>
<strong>Quality Assurance</strong>: Establishing institutional
benchmarks</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">irr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="dataset-overview">Dataset Overview<a class="anchor" aria-label="anchor" href="#dataset-overview"></a>
</h2>
<div class="section level3">
<h3 id="comprehensive-agreement-datasets">Comprehensive Agreement Datasets<a class="anchor" aria-label="anchor" href="#comprehensive-agreement-datasets"></a>
</h3>
<p>The package includes multiple datasets for different agreement
scenarios:</p>
<div class="section level4">
<h4 id="breast-cancer-agreement-study">Breast Cancer Agreement Study<a class="anchor" aria-label="anchor" href="#breast-cancer-agreement-study"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load breast cancer pathologist agreement data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overview of the study</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Study includes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">)</span>, <span class="st">"cases from"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">$</span><span class="va">Institution</span><span class="op">)</span><span class="op">)</span>, <span class="st">"institutions\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview the data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">)</span></span></code></pre></div>
<p>This dataset represents a multi-institutional study of breast cancer
diagnosis agreement with: - <strong>3 pathologists</strong> with
different experience levels - <strong>200 cases</strong> including
various breast lesions<br>
- <strong>4 diagnostic categories</strong>: Benign, Atypical, DCIS,
Invasive Carcinoma - <strong>Institutional variability</strong> across
academic and community settings</p>
</div>
<div class="section level4">
<h4 id="melanoma-agreement-study">Melanoma Agreement Study<a class="anchor" aria-label="anchor" href="#melanoma-agreement-study"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load melanoma agreement data for histologic features</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">melanoma_agreement_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Study characteristics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">melanoma_agreement_data</span><span class="op">$</span><span class="va">Histologic_Subtype</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">melanoma_agreement_data</span><span class="op">$</span><span class="va">Breslow_Category</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="types-of-agreement-analysis">Types of Agreement Analysis<a class="anchor" aria-label="anchor" href="#types-of-agreement-analysis"></a>
</h2>
<div class="section level3">
<h3 id="binary-classifications-cohens-kappa">1. Binary Classifications (Cohenâ€™s Kappa)<a class="anchor" aria-label="anchor" href="#binary-classifications-cohens-kappa"></a>
</h3>
<div class="section level4">
<h4 id="basic-two-rater-agreement">Basic Two-Rater Agreement<a class="anchor" aria-label="anchor" href="#basic-two-rater-agreement"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate agreement between two experienced pathologists</span></span>
<span><span class="va">agreement_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Pathologist_2_Diagnosis"</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"kappa"</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">agreement_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interpretation</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">agreement_result</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&gt;</span> <span class="fl">0.81</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Agreement is ALMOST PERFECT (Îº &gt;0.81)"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">agreement_result</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&gt;</span> <span class="fl">0.61</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Agreement is SUBSTANTIAL (Îº 0.61-0.80)"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">agreement_result</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&gt;</span> <span class="fl">0.41</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Agreement is MODERATE (Îº 0.41-0.60)"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Agreement needs improvement (Îº â‰¤0.40)"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="weighted-kappa-for-ordinal-categories">Weighted Kappa for Ordinal Categories<a class="anchor" aria-label="anchor" href="#weighted-kappa-for-ordinal-categories"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For ordinal variables like tumor grades</span></span>
<span><span class="co"># Convert to ordered factors if needed</span></span>
<span><span class="va">breast_agreement_data</span><span class="op">$</span><span class="va">Grade_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">$</span><span class="va">Grade_Pathologist_1</span>, </span>
<span>                                        levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">breast_agreement_data</span><span class="op">$</span><span class="va">Grade_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">breast_agreement_data</span><span class="op">$</span><span class="va">Grade_Pathologist_2</span>, </span>
<span>                                        levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weighted kappa accounts for degree of disagreement</span></span>
<span><span class="va">weighted_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Grade_1"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Grade_2"</span>, </span>
<span>  agreement_type <span class="op">=</span> <span class="st">"weighted_kappa"</span>,</span>
<span>  weights <span class="op">=</span> <span class="st">"quadratic"</span>,  <span class="co"># Penalizes larger disagreements more</span></span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weighted_agreement</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="multiple-raters-fleiss-kappa">2. Multiple Raters (Fleissâ€™ Kappa)<a class="anchor" aria-label="anchor" href="#multiple-raters-fleiss-kappa"></a>
</h3>
<div class="section level4">
<h4 id="three-pathologist-study-design">Three-Pathologist Study Design<a class="anchor" aria-label="anchor" href="#three-pathologist-study-design"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape data for multiple raters</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create matrix format required for Fleiss' kappa</span></span>
<span><span class="va">multi_rater_data</span> <span class="op">&lt;-</span> <span class="va">breast_agreement_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Case_ID</span>, <span class="va">Pathologist_1_Diagnosis</span>, <span class="va">Pathologist_2_Diagnosis</span>, <span class="va">Pathologist_3_Diagnosis</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Fleiss' kappa</span></span>
<span><span class="va">fleiss_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_rater_data</span>,</span>
<span>  rater_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pathologist_1_Diagnosis"</span>, <span class="st">"Pathologist_2_Diagnosis"</span>, <span class="st">"Pathologist_3_Diagnosis"</span><span class="op">)</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"fleiss"</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fleiss_result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="category-specific-agreement">Category-Specific Agreement<a class="anchor" aria-label="anchor" href="#category-specific-agreement"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine agreement for each diagnostic category</span></span>
<span><span class="va">category_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">multi_rater_data</span>,</span>
<span>  rater_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pathologist_1_Diagnosis"</span>, <span class="st">"Pathologist_2_Diagnosis"</span>, <span class="st">"Pathologist_3_Diagnosis"</span><span class="op">)</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"fleiss"</span>,</span>
<span>  category_specific <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot category-specific kappa values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">category_agreement</span>, type <span class="op">=</span> <span class="st">"category"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="continuous-measurements-icc">3. Continuous Measurements (ICC)<a class="anchor" aria-label="anchor" href="#continuous-measurements-icc"></a>
</h3>
<div class="section level4">
<h4 id="intraclass-correlation-coefficient">Intraclass Correlation Coefficient<a class="anchor" aria-label="anchor" href="#intraclass-correlation-coefficient"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For continuous measurements like Ki-67 percentages</span></span>
<span><span class="va">icc_result</span> <span class="op">&lt;-</span> <span class="fu">icccoeff</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ki67_Pathologist_1"</span>, <span class="st">"Ki67_Pathologist_2"</span>, <span class="st">"Ki67_Pathologist_3"</span><span class="op">)</span>,</span>
<span>  icc_type <span class="op">=</span> <span class="st">"icc2_k"</span>,  <span class="co"># Two-way random effects, average measures</span></span>
<span>  confidence_level <span class="op">=</span> <span class="st">"0.95"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">icc_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ICC interpretation:</span></span>
<span><span class="co"># &lt; 0.50: Poor reliability</span></span>
<span><span class="co"># 0.50-0.75: Moderate reliability  </span></span>
<span><span class="co"># 0.75-0.90: Good reliability</span></span>
<span><span class="co"># &gt; 0.90: Excellent reliability</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bland-altman-analysis">Bland-Altman Analysis<a class="anchor" aria-label="anchor" href="#bland-altman-analysis"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For method comparison studies</span></span>
<span><span class="va">bland_altman_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  method1 <span class="op">=</span> <span class="st">"Ki67_Pathologist_1"</span>,</span>
<span>  method2 <span class="op">=</span> <span class="st">"Ki67_Pathologist_2"</span>,</span>
<span>  analysis_type <span class="op">=</span> <span class="st">"bland_altman"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"difference"</span>,</span>
<span>  limits_of_agreement <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bland_altman_plot</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="factors-affecting-agreement">Factors Affecting Agreement<a class="anchor" aria-label="anchor" href="#factors-affecting-agreement"></a>
</h2>
<div class="section level3">
<h3 id="experience-level-analysis">Experience Level Analysis<a class="anchor" aria-label="anchor" href="#experience-level-analysis"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare agreement by pathologist experience</span></span>
<span><span class="va">experience_comparison</span> <span class="op">&lt;-</span> <span class="va">breast_agreement_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Pathologist_Experience</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    agreement_with_consensus <span class="op">=</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>      rater1_var <span class="op">=</span> <span class="st">"Pathologist_Diagnosis"</span>,</span>
<span>      rater2_var <span class="op">=</span> <span class="st">"Consensus_Diagnosis"</span>,</span>
<span>      agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">kappa</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">experience_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize experience effect</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">experience_comparison</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pathologist_Experience</span>, y <span class="op">=</span> <span class="va">agreement_with_consensus</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Agreement with Consensus by Experience Level"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Pathologist Experience"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Kappa Coefficient"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="case-difficulty-analysis">Case Difficulty Analysis<a class="anchor" aria-label="anchor" href="#case-difficulty-analysis"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine agreement by case difficulty</span></span>
<span><span class="va">difficulty_analysis</span> <span class="op">&lt;-</span> <span class="va">breast_agreement_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    case_difficulty <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Consensus_Confidence</span> <span class="op">&gt;=</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"Easy"</span>,</span>
<span>      <span class="va">Consensus_Confidence</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"Moderate"</span>, </span>
<span>      <span class="va">Consensus_Confidence</span> <span class="op">&lt;=</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"Difficult"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">case_difficulty</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    kappa <span class="op">=</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>      rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>      rater2_var <span class="op">=</span> <span class="st">"Pathologist_2_Diagnosis"</span>, </span>
<span>      agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">kappa</span>,</span>
<span>    n_cases <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">difficulty_analysis</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="study-design-and-sample-size-planning">Study Design and Sample Size Planning<a class="anchor" aria-label="anchor" href="#study-design-and-sample-size-planning"></a>
</h2>
<div class="section level3">
<h3 id="power-analysis-for-agreement-studies">Power Analysis for Agreement Studies<a class="anchor" aria-label="anchor" href="#power-analysis-for-agreement-studies"></a>
</h3>
<div class="section level4">
<h4 id="binary-outcomes">Binary Outcomes<a class="anchor" aria-label="anchor" href="#binary-outcomes"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate sample size for detecting moderate vs substantial agreement</span></span>
<span><span class="va">power_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kappaSizePower.html">kappaSizePower</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="st">"2"</span>,           <span class="co"># Binary outcome</span></span>
<span>  kappa0 <span class="op">=</span> <span class="fl">0.4</span>,           <span class="co"># Null hypothesis (moderate agreement)  </span></span>
<span>  kappa1 <span class="op">=</span> <span class="fl">0.6</span>,           <span class="co"># Alternative hypothesis (substantial agreement)</span></span>
<span>  props <span class="op">=</span> <span class="st">"0.3, 0.7"</span>,     <span class="co"># Expected proportions (30% positive, 70% negative)</span></span>
<span>  raters <span class="op">=</span> <span class="st">"2"</span>,           <span class="co"># Two raters</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,           <span class="co"># Type I error</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.80</span>            <span class="co"># Statistical power</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_analysis</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="multiple-categories">Multiple Categories<a class="anchor" aria-label="anchor" href="#multiple-categories"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size for 4-category diagnostic classification</span></span>
<span><span class="va">power_multicat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kappaSizePower.html">kappaSizePower</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="st">"4"</span>,</span>
<span>  kappa0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  kappa1 <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>  props <span class="op">=</span> <span class="st">"0.25, 0.25, 0.25, 0.25"</span>,  <span class="co"># Equal proportions</span></span>
<span>  raters <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">0.80</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_multicat</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="precision-based-sample-size">Precision-Based Sample Size<a class="anchor" aria-label="anchor" href="#precision-based-sample-size"></a>
</h3>
<div class="section level4">
<h4 id="confidence-interval-approach">Confidence Interval Approach<a class="anchor" aria-label="anchor" href="#confidence-interval-approach"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size for desired precision (CI width)</span></span>
<span><span class="va">precision_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kappaSizeCI.html">kappaSizeCI</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  kappa0 <span class="op">=</span> <span class="fl">0.6</span>,          <span class="co"># Expected kappa</span></span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,     <span class="co"># Confidence level</span></span>
<span>  width <span class="op">=</span> <span class="fl">0.2</span>,           <span class="co"># Desired CI width (Â±0.1 around kappa)</span></span>
<span>  props <span class="op">=</span> <span class="st">"0.4, 0.6"</span>,</span>
<span>  raters <span class="op">=</span> <span class="st">"2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">precision_analysis</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fixed-sample-size-analysis">Fixed Sample Size Analysis<a class="anchor" aria-label="anchor" href="#fixed-sample-size-analysis"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What precision can we achieve with available sample?</span></span>
<span><span class="va">fixed_n_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kappaSizeFixedN.html">kappaSizeFixedN</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  kappa0 <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  props <span class="op">=</span> <span class="st">"0.3, 0.7"</span>, </span>
<span>  raters <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">150</span>               <span class="co"># Available sample size</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fixed_n_result</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-applications">Advanced Applications<a class="anchor" aria-label="anchor" href="#advanced-applications"></a>
</h2>
<div class="section level3">
<h3 id="conditional-kappa-analysis">Conditional Kappa Analysis<a class="anchor" aria-label="anchor" href="#conditional-kappa-analysis"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agreement conditional on true positive/negative status</span></span>
<span><span class="va">conditional_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Pathologist_2_Diagnosis"</span>,</span>
<span>  truth_var <span class="op">=</span> <span class="st">"Gold_Standard"</span>,</span>
<span>  analysis_type <span class="op">=</span> <span class="st">"conditional_kappa"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">conditional_agreement</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-level-agreement-hierarchical">Multi-Level Agreement (Hierarchical)<a class="anchor" aria-label="anchor" href="#multi-level-agreement-hierarchical"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Account for clustering by institution</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">multilevel_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Pathologist_2_Diagnosis"</span>, </span>
<span>  cluster_var <span class="op">=</span> <span class="st">"Institution"</span>,</span>
<span>  analysis_type <span class="op">=</span> <span class="st">"multilevel_kappa"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multilevel_model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="longitudinal-agreement-test-retest">Longitudinal Agreement (Test-Retest)<a class="anchor" aria-label="anchor" href="#longitudinal-agreement-test-retest"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agreement across time points</span></span>
<span><span class="va">test_retest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  time1_var <span class="op">=</span> <span class="st">"Initial_Diagnosis"</span>,</span>
<span>  time2_var <span class="op">=</span> <span class="st">"Repeat_Diagnosis"</span>,</span>
<span>  subject_id <span class="op">=</span> <span class="st">"Case_ID"</span>,</span>
<span>  analysis_type <span class="op">=</span> <span class="st">"test_retest"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test_retest</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quality-assurance-applications">Quality Assurance Applications<a class="anchor" aria-label="anchor" href="#quality-assurance-applications"></a>
</h2>
<div class="section level3">
<h3 id="establishing-qa-benchmarks">Establishing QA Benchmarks<a class="anchor" aria-label="anchor" href="#establishing-qa-benchmarks"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set institutional benchmarks</span></span>
<span><span class="va">qa_standards</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  diagnostic_agreement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    minimum_kappa <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>    target_kappa <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    benchmark_cases <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span>,</span>
<span>  biomarker_scoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    minimum_icc <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    target_icc <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>    benchmark_cases <span class="op">=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Monitor ongoing performance</span></span>
<span><span class="va">current_performance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Consensus_Diagnosis"</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check against benchmark</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">current_performance</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&gt;=</span> <span class="va">qa_standards</span><span class="op">$</span><span class="va">diagnostic_agreement</span><span class="op">$</span><span class="va">target_kappa</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"âœ“ Performance EXCEEDS target benchmark"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">current_performance</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&gt;=</span> <span class="va">qa_standards</span><span class="op">$</span><span class="va">diagnostic_agreement</span><span class="op">$</span><span class="va">minimum_kappa</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"âš  Performance meets minimum but below target"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"âœ— Performance BELOW minimum standard - intervention needed"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="training-assessment">Training Assessment<a class="anchor" aria-label="anchor" href="#training-assessment"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Monitor trainee progress over time</span></span>
<span><span class="va">trainee_progress</span> <span class="op">&lt;-</span> <span class="va">breast_agreement_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Pathologist_Level</span> <span class="op">==</span> <span class="st">"Resident"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Training_Month</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    agreement_with_attending <span class="op">=</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>      rater1_var <span class="op">=</span> <span class="st">"Resident_Diagnosis"</span>,</span>
<span>      rater2_var <span class="op">=</span> <span class="st">"Attending_Diagnosis"</span>, </span>
<span>      agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">kappa</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot learning curve</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">trainee_progress</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Training_Month</span>, y <span class="op">=</span> <span class="va">agreement_with_attending</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.6</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">trainee_progress</span><span class="op">$</span><span class="va">Training_Month</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">0.65</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Minimum Standard"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Resident Training Progress: Agreement with Attending"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Training Month"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Kappa Coefficient"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="interpretation-guidelines">Interpretation Guidelines<a class="anchor" aria-label="anchor" href="#interpretation-guidelines"></a>
</h2>
<div class="section level3">
<h3 id="clinical-significance-vs-statistical-significance">Clinical Significance vs Statistical Significance<a class="anchor" aria-label="anchor" href="#clinical-significance-vs-statistical-significance"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Large sample may show statistical significance for clinically unimportant differences</span></span>
<span><span class="va">large_study_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">large_agreement_dataset</span>,  <span class="co"># Hypothetical large dataset</span></span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Rater1"</span>, </span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Rater2"</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Consider both p-value AND effect size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Statistical significance: p ="</span>, <span class="va">large_study_result</span><span class="op">$</span><span class="va">p_value</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Clinical significance: Îº ="</span>, <span class="va">large_study_result</span><span class="op">$</span><span class="va">kappa</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">large_study_result</span><span class="op">$</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="va">large_study_result</span><span class="op">$</span><span class="va">kappa</span> <span class="op">&lt;</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Statistically significant but clinically inadequate agreement"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reporting-standards">Reporting Standards<a class="anchor" aria-label="anchor" href="#reporting-standards"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Template for reporting agreement results</span></span>
<span><span class="va">agreement_report</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Agreement Analysis Report\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"========================\n\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sample size:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">n</span>, <span class="st">"cases\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Kappa coefficient:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">kappa</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>      <span class="st">"(95% CI:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">ci_lower</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">ci_upper</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"P-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html" class="external-link">format.pval</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Interpretation:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">interpretation</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Recommendation:"</span>, <span class="va">result</span><span class="op">$</span><span class="va">recommendation</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example usage</span></span>
<span><span class="va">main_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/agreement.html">agreement</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">breast_agreement_data</span>,</span>
<span>  rater1_var <span class="op">=</span> <span class="st">"Pathologist_1_Diagnosis"</span>,</span>
<span>  rater2_var <span class="op">=</span> <span class="st">"Pathologist_2_Diagnosis"</span>,</span>
<span>  agreement_type <span class="op">=</span> <span class="st">"kappa"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">agreement_report</span><span class="op">(</span><span class="va">main_result</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="best-practices-and-recommendations">Best Practices and Recommendations<a class="anchor" aria-label="anchor" href="#best-practices-and-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="study-design-considerations">Study Design Considerations<a class="anchor" aria-label="anchor" href="#study-design-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Sample Size Planning</strong>
<ul>
<li>Use power analysis for hypothesis testing</li>
<li>Use precision analysis for descriptive studies</li>
<li>Account for expected agreement levels and prevalence</li>
</ul>
</li>
<li>
<strong>Rater Selection</strong>
<ul>
<li>Include raters representative of intended users</li>
<li>Balance experience levels appropriately</li>
<li>Ensure adequate training before study</li>
</ul>
</li>
<li>
<strong>Case Selection</strong>
<ul>
<li>Include full spectrum of difficulty</li>
<li>Ensure adequate representation of all categories</li>
<li>Consider enrichment for rare categories</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="statistical-considerations">Statistical Considerations<a class="anchor" aria-label="anchor" href="#statistical-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Choose Appropriate Measure</strong>
<ul>
<li>Cohenâ€™s kappa: Two raters, nominal/ordinal data</li>
<li>Weighted kappa: Ordinal data with meaningful ordering</li>
<li>Fleissâ€™ kappa: Multiple raters, nominal data</li>
<li>ICC: Continuous measurements</li>
</ul>
</li>
<li>
<strong>Account for Prevalence Effects</strong>
<ul>
<li>Kappa can be low even with high percentage agreement if prevalence
is extreme</li>
<li>Report both kappa and percentage agreement</li>
<li>Consider prevalence-adjusted kappa when appropriate</li>
</ul>
</li>
<li>
<strong>Multiple Comparisons</strong>
<ul>
<li>Adjust p-values when testing multiple agreements</li>
<li>Focus on clinically important comparisons</li>
<li>Report confidence intervals rather than just p-values</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="regulatory-considerations">Regulatory Considerations<a class="anchor" aria-label="anchor" href="#regulatory-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>FDA Guidance Compliance</strong>
<ul>
<li>Document predefined acceptable agreement levels</li>
<li>Include appropriate statistical analysis plan</li>
<li>Consider regulatory precedents for similar devices/tests</li>
</ul>
</li>
<li>
<strong>Quality Assurance Integration</strong>
<ul>
<li>Establish ongoing monitoring procedures</li>
<li>Define trigger levels for intervention</li>
<li>Document corrective action procedures</li>
</ul>
</li>
</ol>
<hr>
<p>This comprehensive guide provides pathologists and clinical
researchers with the tools and knowledge needed to conduct rigorous
agreement studies, from initial planning through final interpretation
and quality assurance implementation.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Serdar Balci.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
