title: ROC Analysis
name: psychopdaroc
jus: '3.0'
stage: 0
compilerMode: tame
children:
  # ==========================================
  # VARIABLES SECTION - Keep at the top
  # ==========================================
  - type: VariableSupplier
    persistentItems: false
    stretchFactor: 1
    children:
      - type: TargetLayoutBox
        label: Dependent Variable
        children:
          - type: VariablesListBox
            name: dependentVars
            isTarget: true
      - type: TargetLayoutBox
        label: Class Variable
        children:
          - type: VariablesListBox
            name: classVar
            maxItemCount: 1
            isTarget: true
          - type: LevelSelector
            name: positiveClass
            enable: (classVar)
      - type: TargetLayoutBox
        label: Group Variable
        children:
          - type: VariablesListBox
            name: subGroup
            maxItemCount: 1
            isTarget: true

  # ==========================================
  # MAIN ANALYSIS OPTIONS - Basic settings
  # ==========================================
  - type: CollapseBox
    label: Analysis Options
    margin: normal
    collapsed: false  # Open by default
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: method
            label: Method
          - type: CheckBox
            name: allObserved
            label: Show all observed cutpoints
          - type: TextBox
            name: specifyCutScore
            format: string
            enable: method:oc_manual
            label: Custom cut score
          - type: ComboBox
            name: direction
            label: Direction

  # ==========================================
  # PREVALENCE SETTINGS - Group related options
  # ==========================================
  - type: CollapseBox
    label: Prevalence Settings
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: usePriorPrev
            label: Use prior prevalence
          - type: TextBox
            name: priorPrev
            format: number
            label: Prior prevalence value
            enable: (usePriorPrev)
          - type: TextBox
            name: costratioFP
            format: number
            label: Cost ratio (FP/FN)

  # ==========================================
  # VISUALIZATION OPTIONS - All plot-related items
  # ==========================================
  - type: CollapseBox
    label: Visualization
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Basic Plot Settings
            children:
              - type: CheckBox
                name: plotROC
                label: Show ROC curves
              - type: CheckBox
                name: combinePlots
                label: Combine all curves in one plot
                enable: (plotROC)
              - type: CheckBox
                name: showOptimalPoint
                label: Show optimal cutpoint
                enable: (plotROC)
              - type: CheckBox
                name: directLabel
                label: Label curves directly
                enable: (plotROC && combinePlots)
          
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Plot Style
            children:
              - type: CheckBox
                name: cleanPlot
                label: Publication-quality plot
              - type: ComboBox
                name: legendPosition
                label: Legend position
              - type: CheckBox
                name: smoothing
                label: Apply LOESS smoothing
              - type: CheckBox
                name: interactiveROC
                label: Create interactive plot

      - type: LayoutBox
        margin: large
        children:
          - type: Label 
            label: Additional Information
            children:
              - type: CheckBox
                name: displaySE
                label: Show standard error bars
                enable: (!cleanPlot)
              - type: CheckBox
                name: showConfidenceBands
                label: Show confidence bands
                enable: (!cleanPlot)
              - type: CheckBox
                name: quantileCIs
                label: Show confidence intervals at quantiles
              - type: TextBox
                name: quantiles
                format: string
                label: Quantile positions
                enable: (quantileCIs)

  # ==========================================
  # ADDITIONAL OUTPUTS
  # ==========================================
  - type: CollapseBox
    label: Additional Outputs
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: sensSpecTable
            label: Show sensitivity/specificity tables
          - type: CheckBox
            name: showThresholdTable
            label: Show threshold table
          - type: TextBox
            name: maxThresholds
            format: number
            label: Maximum thresholds to display
            enable: (showThresholdTable)
          - type: CheckBox
            name: delongTest
            label: Perform DeLong's test for comparing AUCs

      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Model Comparison
            children:
              - type: CheckBox
                name: calculateIDI
                label: Calculate IDI
              - type: CheckBox
                name: calculateNRI
                label: Calculate NRI
              - type: LevelSelector
                name: refVar
                label: Reference Variable
                enable: (calculateIDI || calculateNRI)
              - type: TextBox
                name: nriThresholds
                format: string
                label: NRI Thresholds
                enable: (calculateNRI)
              - type: TextBox
                name: idiNriBootRuns
                format: number
                label: Bootstrap Runs
                enable: (calculateIDI || calculateNRI)




  # ==========================================
  # ADDITIONAL PLOTS 
  # ==========================================
  - type: CollapseBox
    label: Additional Plots
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: showCriterionPlot
            label: Sensitivity/Specificity vs. Threshold
          - type: CheckBox
            name: showPrevalencePlot
            label: Predictive Values vs. Prevalence
          - type: CheckBox
            name: showDotPlot
            label: Test Values Distribution

  # ==========================================
  # ADVANCED OPTIONS
  # ==========================================
  - type: CollapseBox
    label: Advanced
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: metric
            label: Optimization metric
          - type: TextBox
            name: tol_metric
            format: number
            label: Metric tolerance
          - type: ComboBox
            name: break_ties
            label: Tie-breaking method
          - type: TextBox
            name: boot_runs
            format: number
            label: Bootstrap runs


  - type: CollapseBox
    label: pROC Features
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: partialAUC
            label: Compute partial AUC
          - type: TextBox
            name: partialAUCfrom
            format: number
            label: Partial AUC from specificity
            enable: (partialAUC)
          - type: TextBox
            name: partialAUCto
            format: number
            label: Partial AUC to specificity
            enable: (partialAUC)
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: rocSmoothingMethod
            label: ROC curve smoothing method
          - type: CheckBox
            name: bootstrapCI
            label: Bootstrap confidence intervals
          - type: TextBox
            name: bootstrapReps
            format: number
            label: Bootstrap replications
            enable: (bootstrapCI)


# Add to the psychopdaroc.u.yaml file
  - type: CollapseBox
    label: Multiple ROC Features
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: compareClassifiers
            label: Compare classifiers' performance
          - type: CheckBox
            name: precisionRecallCurve
            label: Precision-Recall curve